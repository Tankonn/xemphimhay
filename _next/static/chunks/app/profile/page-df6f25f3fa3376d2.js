(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{3246:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>R});var r=s(5155),a=s(9137),o=s.n(a),i=s(2115),l=s(8126),n=s.n(l),c=s(6874),d=s.n(c),m=s(6686),f=s(366),x=s(4065),h=s(6186),g=s(662),p=s(3038),j=s(9361),u=s(4947),y=s(5032),b=s(2515),v=s(6124),w=s(5682),N=s(998),A=s(5069),k=s(9622),F=s(274),C=s(3993),I=s(3231),E=s(3867),z=s(4413),S=s(5695);let{Title:_,Paragraph:D,Text:B}=m.A,R=()=>{let[e,t]=(0,i.useState)(null),[s,a]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[m,R]=(0,i.useState)(!0),[T,P]=(0,i.useState)(null),[W,M]=(0,i.useState)(!1),[U,O]=(0,i.useState)(!1),[L,H]=(0,i.useState)(!1),[J,K]=(0,i.useState)({film:null,action:"add"}),[V,q]=(0,i.useState)(!1),[G,Y]=(0,i.useState)(null),[Q,X]=(0,i.useState)(!1),[Z,$]=(0,i.useState)(null),[ee,et]=(0,i.useState)(null),[es]=f.A.useForm(),er=(0,S.useRouter)(),[ea,eo]=(0,i.useState)([]),[ei,el]=(0,i.useState)(!1),[en,ec]=(0,i.useState)("recent");(0,i.useEffect)(()=>{let e=localStorage.getItem("token");if(!e)return void er.push("/login");M(!0),ed(e)},[er]);let ed=async e=>{try{R(!0),console.log("Fetching user data with token:",e);let s=await fetch("http://localhost:2000/auth/profile",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){if(401===s.status)throw localStorage.removeItem("token"),er.push("/login"),Error("Session expired. Please login again.");let e=await s.json();throw console.error("Profile fetch error:",e),Error(e.message||"API error: ".concat(s.status))}let r=await s.json();if(console.log("User data received:",r),!r||!r._id)throw console.error("Invalid user data received:",r),Error("Invalid user data received");let a=r._id;if(t({_id:a,username:r.username||"anime_lover",email:r.email||"user@example.com",profileImage:r.profileImage||"/img/user/default-avatar.jpg",bio:r.bio||"Anime enthusiast and collector. I love watching fantasy and action anime!",joinDate:r.createdAt||new Date().toISOString(),watchedCount:r.watchedCount||0,favoriteCount:r.favoriteCount||0}),a){try{await em(e,a)}catch(e){console.error("Error in fetchFavorites:",e)}try{await ef(e)}catch(e){console.error("Error in fetchWatchHistory:",e)}}try{await ex(e,a)}catch(e){console.error("Error in fetchUserRatings:",e)}P(null)}catch(e){if(console.error("Error fetching user data:",e),P(e instanceof Error?e.message:"Failed to load user profile"),e instanceof Error&&e.message.includes("Session expired"))return;t({_id:"1",username:"anime_lover",email:"user@example.com",profileImage:"/img/user/default-avatar.jpg",bio:"Anime enthusiast and collector. I love watching fantasy and action anime!",joinDate:"2023-05-15",watchedCount:45,favoriteCount:12}),a([]),c([])}finally{R(!1)}},em=async(s,r)=>{try{if(!r&&!(null==e?void 0:e._id)){let e=localStorage.getItem("userId");if(!e)return void console.log("No user ID available for fetching favorites");r=e}let o=r||(null==e?void 0:e._id);console.log("Fetching favorites for user ID:",o);let i=await fetch("http://localhost:2000/favorites/user/".concat(o),{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!i.ok){let e=await i.json();throw Error(e.message||"Failed to fetch favorites: ".concat(i.status))}let l=await i.json();console.log("Favorites data:",l),a(l),t(e=>e?{...e,favoriteCount:l.length}:null)}catch(e){console.error("Error fetching favorites:",e),a([])}},ef=async e=>{try{let s=localStorage.getItem("userId");if(!s){console.error("No user ID available for fetching watch history"),c([]);return}let r=await fetch("http://localhost:2000/watch-history/user/".concat(s),{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();console.log("Watch history data:",e);let s=e.map(e=>{let t=e.movieId&&"object"==typeof e.movieId?e.movieId:{},s=t._id||e.movieId,r=!0===e.completed||!0===e.watched||"number"==typeof e.watchTime&&e.watchTime>0||"number"==typeof e.progress&&e.progress>=90;return{_id:s,movieId:s,name:t.name||e.movieName||"Unknown Title",image:t.image||e.image||"/img/anime/default-poster.jpg",category:t.category||e.category||"",episode:"Episode ".concat(e.episodeNumber||"?"),isWatched:r,progress:e.progress||e.watchTime||0,timestamp:e.updatedAt||e.timestamp||new Date().toISOString(),episodeId:e.episodeId||"",duration:t.duration||e.duration||"0:00"}});s.sort((e,t)=>new Date(t.timestamp||"").getTime()-new Date(e.timestamp||"").getTime()),c(s);let a=new Set;s.forEach(e=>{e.isWatched&&a.add(e._id)}),t(e=>e?{...e,watchedCount:a.size}:null)}else{let e=await r.text();throw console.error("Failed to fetch watch history:",e),Error("Failed to fetch watch history")}}catch(e){console.error("Error fetching watch history:",e),c([])}},ex=async(e,t)=>{try{el(!0);let s=await fetch("http://localhost:2000/movies/ratings/user/".concat(t),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();console.log("User ratings data:",e);let t=e.data||[],r=[];Array.isArray(t)&&(r=t.map(e=>{let t=e.movie||{};return{_id:e.ratingId||e._id,movieId:{_id:t._id||e.movieId,name:t.name||"Unknown Title",image:t.image||"default-poster.jpg",category:t.category||""},rating:e.rating,createdAt:e.createdAt||new Date().toISOString()}})),console.log("Processed ratings:",r),eo(r)}else console.error("Failed to fetch user ratings:",await s.text()),eo([])}catch(e){console.error("Error fetching user ratings:",e),eo([])}finally{el(!1)}},eh=e=>{if(!e._id)return void x.Ay.error({message:"Error",description:"Unable to resume. Missing movie information.",placement:"topRight"});let t=0;e.progress&&e.progress>0&&e.progress<100&&(t=e.progress),localStorage.setItem("resumeTime",t.toString()),e.episodeId&&localStorage.setItem("resumeEpisodeId",e.episodeId);let s=e.episodeId?"id=".concat(e._id,"&resume=true&episodeId=").concat(e.episodeId):"id=".concat(e._id,"&resume=true");er.push("/detail?".concat(s))},eg=async t=>{try{et(t);let r=localStorage.getItem("token");if(!r){let e=l.find(e=>e._id===t);e?(Y(e),q(!0)):x.Ay.error({message:"Authentication Error",description:"Please log in to add favorites.",placement:"topRight",duration:3}),et(null);return}let a=(null==e?void 0:e._id)||localStorage.getItem("userId");if(!a){x.Ay.error({message:"User ID Error",description:"User ID not found. Please try logging in again.",placement:"topRight",duration:3}),et(null);return}if(s.some(e=>e._id===t)){x.Ay.info({message:"Already Favorite",description:"This anime is already in your favorites.",placement:"topRight",duration:2}),et(null);return}let o=l.find(e=>e._id===t);console.log("Film data for add favorite:",o);let i=await fetch("http://localhost:2000/favorites",{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({userId:a,movieId:t})});if(!i.ok){let e=await i.json();throw Error(e.message||"Failed to add to favorites")}let n=await i.json();console.log("Added to favorites:",n),await em(r,a.toString()),et(null),o?(K({film:o,action:"add"}),H(!0)):x.Ay.success({message:"Success",description:"Added to favorites successfully!",placement:"topRight",duration:2})}catch(e){console.error("Error adding to favorites:",e),x.Ay.error({message:"Error",description:e instanceof Error?e.message:"Failed to add to favorites",placement:"topRight",duration:3}),et(null)}},ep=async e=>{et(e);let t=s.find(t=>t._id===e);console.log("Film data for remove favorite:",t),t?($(t),X(!0)):x.Ay.error({message:"Error",description:"Could not find film information",placement:"topRight",duration:3}),et(null)},ej=async()=>{if(Z)try{et(Z._id);let e=localStorage.getItem("token");if(!e){x.Ay.error({message:"Authentication Error",description:"Please log in to manage favorites.",placement:"topRight",duration:3}),et(null);return}let r=await fetch("http://localhost:2000/favorites/".concat(Z._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to remove from favorites")}a(s.filter(e=>e._id!==Z._id)),t(e=>e?{...e,favoriteCount:e.favoriteCount-1}:null),X(!1),et(null),K({film:Z,action:"remove"}),H(!0)}catch(e){console.error("Error removing from favorites:",e),x.Ay.error({message:"Error",description:e instanceof Error?e.message:"Failed to remove from favorites",placement:"topRight",duration:3}),et(null)}},eu=e=>e?e.startsWith("http")?e:"/img/anime/".concat(e):"/img/anime/default-poster.jpg",ey=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),eb=e=>{let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/1e3);return s<60?"Just now":s<3600?"".concat(Math.floor(s/60)," minutes ago"):s<86400?"".concat(Math.floor(s/3600)," hours ago"):s<2592e3?"".concat(Math.floor(s/86400)," days ago"):ey(e)};return(0,r.jsxs)("div",{className:"jsx-1e87211474166fef bg-gray-900 text-gray-200 min-h-screen",children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{className:"jsx-1e87211474166fef",children:"My Profile - Anime"}),(0,r.jsx)("meta",{name:"description",content:"User profile and favorite anime",className:"jsx-1e87211474166fef"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico",className:"jsx-1e87211474166fef"})]}),(0,r.jsx)(h.A,{open:L,onCancel:()=>H(!1),footer:[(0,r.jsx)(g.Ay,{type:"primary",onClick:()=>H(!1),style:{backgroundColor:"add"===J.action?"#52c41a":"#EF4444",borderColor:"add"===J.action?"#52c41a":"#EF4444"},children:"OK"},"ok")],title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},className:"jsx-1e87211474166fef",children:"add"===J.action?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{style:{color:"#52c41a",marginRight:"8px"}})," Added to Favorites!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.A,{style:{color:"#EF4444",marginRight:"8px"}})," Removed from Favorites"]})}),centered:!0,width:{xs:"90%",sm:400},className:"add"===J.action?"favorites-modal-add":"favorites-modal-remove",style:{top:100},styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:J.film&&(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col sm:flex-row items-center sm:items-start",children:[(0,r.jsx)("div",{className:"jsx-1e87211474166fef w-20 h-20 mx-auto sm:mx-0 sm:mr-4 mb-4 sm:mb-0 overflow-hidden rounded",children:(0,r.jsx)("img",{src:eu(J.film.image),alt:J.film.name,className:"jsx-1e87211474166fef w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center sm:text-left",children:[(0,r.jsx)("h3",{className:"jsx-1e87211474166fef text-lg font-bold mb-1",children:J.film.name}),"add"===J.action?(0,r.jsx)("p",{className:"jsx-1e87211474166fef",children:"Successfully added to your favorites list"}):(0,r.jsx)("p",{className:"jsx-1e87211474166fef",children:"Successfully removed from your favorites list"}),J.film.category&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef mt-2 flex justify-center sm:justify-start",children:(0,r.jsx)("span",{className:"jsx-1e87211474166fef badge badge-category",children:J.film.category})})]})]})}),(0,r.jsx)(h.A,{open:V,onCancel:()=>q(!1),footer:[(0,r.jsx)(g.Ay,{type:"primary",onClick:()=>{q(!1),er.push("/login")},style:{backgroundColor:"#EF4444",borderColor:"#EF4444"},children:"Go to Login"},"login"),(0,r.jsx)(g.Ay,{onClick:()=>q(!1),children:"Cancel"},"cancel")],title:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:"jsx-1e87211474166fef",children:[(0,r.jsx)(F.A,{style:{color:"#EF4444",marginRight:"8px"}})," Login Required"]}),centered:!0,width:{xs:"90%",sm:400},className:"favorites-modal-remove",style:{top:100},styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col sm:flex-row items-center sm:items-start",children:[G&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef w-20 h-20 mx-auto sm:mx-0 sm:mr-4 mb-4 sm:mb-0 overflow-hidden rounded",children:(0,r.jsx)("img",{src:eu(G.image),alt:G.name,className:"jsx-1e87211474166fef w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center sm:text-left",children:[(0,r.jsx)("h3",{className:"jsx-1e87211474166fef text-lg font-bold mb-1",children:G?G.name:"This anime"}),(0,r.jsx)("p",{className:"jsx-1e87211474166fef",children:"You need to be logged in to add items to your favorites list."}),(0,r.jsx)("p",{className:"jsx-1e87211474166fef mt-2",children:"Would you like to go to the login page?"})]})]})}),(0,r.jsx)(h.A,{open:Q,onCancel:()=>X(!1),footer:[(0,r.jsx)(g.Ay,{onClick:()=>X(!1),children:"Cancel"},"cancel"),(0,r.jsx)(g.Ay,{type:"primary",danger:!0,onClick:ej,children:"Remove"},"remove")],title:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:"jsx-1e87211474166fef",children:[(0,r.jsx)(k.A,{style:{color:"#EF4444",marginRight:"8px"}})," Remove from Favorites"]}),centered:!0,width:{xs:"90%",sm:400},className:"favorites-modal-remove",style:{top:100},styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col sm:flex-row items-center sm:items-start",children:[Z&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef w-20 h-20 mx-auto sm:mx-0 sm:mr-4 mb-4 sm:mb-0 overflow-hidden rounded",children:(0,r.jsx)("img",{src:eu(Z.image),alt:Z.name,className:"jsx-1e87211474166fef w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center sm:text-left",children:[(0,r.jsx)("h3",{className:"jsx-1e87211474166fef text-lg font-bold mb-1",children:Z?Z.name:"This anime"}),(0,r.jsx)("p",{className:"jsx-1e87211474166fef",children:"Are you sure you want to remove this anime from your favorites?"}),(0,r.jsx)("p",{className:"jsx-1e87211474166fef mt-2",children:"This action cannot be undone."})]})]})}),(0,r.jsx)("main",{className:"jsx-1e87211474166fef container mx-auto px-4 py-8",children:m?(0,r.jsx)("div",{className:"jsx-1e87211474166fef flex justify-center items-center h-96",children:(0,r.jsx)(p.A,{size:"large"})}):T?(0,r.jsx)("div",{className:"jsx-1e87211474166fef bg-red-500 bg-opacity-20 border border-red-500 text-white p-4 mb-6 rounded",children:T}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"jsx-1e87211474166fef bg-gray-800 rounded-lg p-6 mb-8",children:(0,r.jsxs)(j.A,{gutter:24,align:"middle",children:[(0,r.jsx)(u.A,{md:6,sm:24,className:"text-center mb-4 md:mb-0",children:(0,r.jsx)("div",{className:"jsx-1e87211474166fef relative inline-block",children:(0,r.jsx)(y.A,{size:128,src:(()=>{if(null==e?void 0:e.profileImage)if(e.profileImage.startsWith("http"))return e.profileImage;else return"/img/user/".concat(e.profileImage);return"/img/user/default-avatar.jpg"})(),icon:(0,r.jsx)(F.A,{}),style:{border:"4px solid #EF4444"}})})}),(0,r.jsxs)(u.A,{md:18,sm:24,children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[(0,r.jsx)(_,{level:2,style:{color:"white",margin:0},children:null==e?void 0:e.username}),(0,r.jsx)(g.Ay,{type:"primary",icon:(0,r.jsx)(C.A,{}),style:{backgroundColor:"#EF4444",borderColor:"#EF4444"},className:"mt-2 md:mt-0",onClick:()=>{es.setFieldsValue({username:null==e?void 0:e.username,email:null==e?void 0:e.email,bio:null==e?void 0:e.bio}),O(!0)},children:"Edit Profile"})]}),(0,r.jsx)(D,{style:{color:"#D1D5DB",marginBottom:"1rem"},children:null==e?void 0:e.bio}),(0,r.jsxs)(j.A,{gutter:16,children:[(0,r.jsx)(u.A,{span:8,md:6,children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center",children:[(0,r.jsx)(I.A,{style:{color:"#EF4444",marginRight:"0.5rem"}}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef",children:[(0,r.jsx)(B,{style:{color:"#9CA3AF",display:"block"},children:"Joined"}),(0,r.jsx)(B,{style:{color:"white"},children:(null==e?void 0:e.joinDate)?ey(e.joinDate):"N/A"})]})]})}),(0,r.jsx)(u.A,{span:8,md:6,children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center",children:[(0,r.jsx)(A.A,{style:{color:"#EF4444",marginRight:"0.5rem"}}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef",children:[(0,r.jsx)(B,{style:{color:"#9CA3AF",display:"block"},children:"Favorites"}),(0,r.jsxs)(B,{style:{color:"white"},children:[(null==e?void 0:e.favoriteCount)||0," anime"]})]})]})})]})]})]})}),(0,r.jsx)(b.A,{defaultActiveKey:"favorites",className:"profile-tabs",items:[{key:"favorites",label:(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-lg",children:[(0,r.jsx)(A.A,{style:{marginRight:"0.5rem"}}),"Favorites"]}),children:0===s.length?(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center py-12 bg-gray-800 rounded-lg",children:[(0,r.jsx)(k.A,{style:{fontSize:"48px",color:"#4B5563",marginBottom:"1rem"}}),(0,r.jsx)(_,{level:4,style:{color:"#9CA3AF"},children:"No favorites yet"}),(0,r.jsx)(D,{style:{color:"#6B7280"},children:"Start adding anime to your favorites list!"}),(0,r.jsx)(g.Ay,{type:"primary",style:{backgroundColor:"#EF4444",borderColor:"#EF4444",marginTop:"1rem"},onClick:()=>er.push("/home"),children:"Browse Anime"})]}):(0,r.jsx)(j.A,{gutter:[16,24],children:s.map(e=>(0,r.jsx)(u.A,{lg:6,md:8,sm:12,xs:24,children:(0,r.jsx)(v.A,{hoverable:!0,className:"bg-gray-800 border-gray-700 overflow-hidden favorite-card",style:{backgroundColor:"#1F2937",borderColor:"#374151"},cover:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef relative",children:[(0,r.jsx)("div",{style:{backgroundImage:"url(".concat(eu(e.image),")")},className:"jsx-1e87211474166fef h-48 bg-cover bg-center"}),e.category&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef category-badge",children:e.category}),e.episode&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef episode-badge",children:(0,r.jsx)("span",{className:"jsx-1e87211474166fef",children:e.episode})}),(0,r.jsx)("div",{className:"jsx-1e87211474166fef absolute bottom-2 left-2 favorite-btn",children:s.some(t=>t._id===e._id)?(0,r.jsx)(g.Ay,{type:"primary",danger:!0,icon:ee===e._id?(0,r.jsx)(E.A,{}):(0,r.jsx)(A.A,{}),className:"rounded-full heart-btn",onClick:t=>{t.stopPropagation(),ep(e._id)}}):(0,r.jsx)(g.Ay,{type:"primary",danger:!0,icon:ee===e._id?(0,r.jsx)(E.A,{}):(0,r.jsx)(k.A,{}),className:"rounded-full heart-btn",onClick:t=>{t.stopPropagation(),eg(e._id)}})}),e.rating&&(0,r.jsxs)("div",{title:"".concat(e.rating.toFixed(1),"/5 from ").concat(e.ratingCount||0," ratings"),className:"jsx-1e87211474166fef rating-badge",children:[(0,r.jsx)(z.A,{className:"star-icon"}),(0,r.jsx)("span",{className:"jsx-1e87211474166fef",children:e.rating.toFixed(1)}),(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-xs ml-1",children:["(",e.ratingCount?e.ratingCount>999?"".concat((e.ratingCount/1e3).toFixed(1),"k"):e.ratingCount:"0",")"]})]})]}),children:(0,r.jsx)(d(),{href:"/detail?id=".concat(e._id),children:(0,r.jsx)(v.A.Meta,{title:(0,r.jsx)("span",{style:{color:"white"},className:"jsx-1e87211474166fef",children:e.name}),description:(0,r.jsx)("div",{style:{color:"#9CA3AF"},className:"jsx-1e87211474166fef",children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col",children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center justify-between mb-1",children:[(0,r.jsx)("span",{className:"jsx-1e87211474166fef mr-4",children:e.category}),e.episode&&(0,r.jsx)("span",{style:{color:"#D1D5DB"},className:"jsx-1e87211474166fef rounded text-xs",children:e.episode})]}),void 0!==e.progress&&(0,r.jsxs)("div",{className:"jsx-1e87211474166fef mt-1",children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center justify-between",children:[(0,r.jsx)("span",{className:"jsx-1e87211474166fef text-xs",children:e.isWatched?"Watched":"In progress"}),(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-xs",children:[e.progress,"%"]})]}),(0,r.jsx)("div",{className:"jsx-1e87211474166fef w-full bg-gray-700 rounded-full h-1.5 mt-1",children:(0,r.jsx)("div",{style:{width:"".concat(e.progress,"%")},className:"jsx-1e87211474166fef bg-red-500 h-1.5 rounded-full"})}),e.timestamp&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef text-xs mt-1 text-gray-500",children:eb(e.timestamp)})]})]})})})})})},e._id))})},{key:"history",label:(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-lg",children:[(0,r.jsx)(I.A,{style:{marginRight:"0.5rem"}}),"Watch History"]}),children:0===l.length?(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center py-12 bg-gray-800 rounded-lg",children:[(0,r.jsx)(I.A,{style:{fontSize:"48px",color:"#4B5563",marginBottom:"1rem"}}),(0,r.jsx)(_,{level:4,style:{color:"#9CA3AF"},children:"No watch history yet"}),(0,r.jsx)(D,{style:{color:"#6B7280"},children:"Start watching anime to build your history!"}),(0,r.jsx)(g.Ay,{type:"primary",style:{backgroundColor:"#EF4444",borderColor:"#EF4444",marginTop:"1rem"},onClick:()=>er.push("/home"),children:"Browse Anime"})]}):(0,r.jsx)(w.A,{itemLayout:"horizontal",dataSource:l,renderItem:e=>(0,r.jsxs)(w.A.Item,{style:{borderBottom:"1px solid #374151"},children:[(0,r.jsx)(w.A.Item.Meta,{avatar:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef w-24 h-16 overflow-hidden rounded relative",children:[(0,r.jsx)("div",{style:{backgroundImage:"url(".concat(eu(e.image),")")},className:"jsx-1e87211474166fef h-full w-full bg-cover bg-center"}),e.episode&&(0,r.jsx)("div",{style:{top:"2px",left:"2px",fontSize:"0.65rem"},className:"jsx-1e87211474166fef episode-badge",children:e.episode})]}),title:(0,r.jsx)(d(),{href:"/detail?id=".concat(e._id),className:"text-white hover:text-red-500 list-item-title",children:e.name}),description:(0,r.jsx)("div",{style:{color:"#9CA3AF"},className:"jsx-1e87211474166fef",children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col",children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center justify-between mb-1",children:[(0,r.jsx)("span",{className:"jsx-1e87211474166fef mr-4",children:e.category}),e.episode&&(0,r.jsx)("span",{style:{color:"#D1D5DB"},className:"jsx-1e87211474166fef rounded text-xs",children:e.episode})]}),void 0!==e.progress&&(0,r.jsxs)("div",{className:"jsx-1e87211474166fef mt-1",children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center justify-between",children:[(0,r.jsx)("span",{className:"jsx-1e87211474166fef text-xs",children:e.isWatched?"Watched":"In progress"}),(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-xs",children:[e.progress,"%"]})]}),(0,r.jsx)("div",{className:"jsx-1e87211474166fef w-full bg-gray-700 rounded-full h-1.5 mt-1",children:(0,r.jsx)("div",{style:{width:"".concat(e.progress,"%")},className:"jsx-1e87211474166fef bg-red-500 h-1.5 rounded-full"})}),e.timestamp&&(0,r.jsx)("div",{className:"jsx-1e87211474166fef text-xs mt-1 text-gray-500",children:eb(e.timestamp)})]})]})})}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex space-x-2",children:[(0,r.jsx)(g.Ay,{type:"primary",style:{backgroundColor:"#EF4444",borderColor:"#EF4444"},size:"small",onClick:()=>eh(e),children:"Resume"}),s.some(t=>t._id===e._id)?(0,r.jsx)(g.Ay,{icon:ee===e._id?(0,r.jsx)(E.A,{}):(0,r.jsx)(A.A,{}),danger:!0,size:"small",onClick:()=>ep(e._id),children:"Remove from Favorites"}):(0,r.jsx)(g.Ay,{icon:ee===e._id?(0,r.jsx)(E.A,{}):(0,r.jsx)(k.A,{}),style:{backgroundColor:"#374151",borderColor:"#374151",color:"white"},size:"small",onClick:()=>eg(e._id),children:"Add to Favorites"})]})]})})},{key:"ratings",label:(0,r.jsxs)("span",{className:"jsx-1e87211474166fef text-lg",children:[(0,r.jsx)(z.A,{style:{marginRight:"0.5rem"}}),"My Ratings"]}),children:ei?(0,r.jsx)("div",{className:"jsx-1e87211474166fef flex justify-center py-12",children:(0,r.jsx)(p.A,{size:"large"})}):0===ea.length?(0,r.jsxs)("div",{className:"jsx-1e87211474166fef text-center py-12 bg-gray-800 rounded-lg",children:[(0,r.jsx)(z.A,{style:{fontSize:"48px",color:"#4B5563",marginBottom:"1rem"}}),(0,r.jsx)(_,{level:4,style:{color:"#9CA3AF"},children:"No ratings yet"}),(0,r.jsx)(D,{style:{color:"#6B7280"},children:"Start rating anime to build your ratings collection!"}),(0,r.jsx)(g.Ay,{type:"primary",style:{backgroundColor:"#EF4444",borderColor:"#EF4444",marginTop:"1rem"},onClick:()=>er.push("/home"),children:"Browse Anime"})]}):(0,r.jsx)(w.A,{itemLayout:"horizontal",dataSource:ea,renderItem:e=>(0,r.jsxs)(w.A.Item,{style:{borderBottom:"1px solid #374151"},children:[(0,r.jsx)(w.A.Item.Meta,{avatar:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef w-24 h-16 overflow-hidden rounded relative",children:[(0,r.jsx)("div",{style:{backgroundImage:"url(/img/anime/".concat(e.movieId.image,")")},className:"jsx-1e87211474166fef h-full w-full bg-cover bg-center"}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef absolute bottom-0 right-0 bg-black bg-opacity-75 px-1 py-0.5 text-yellow-400 text-xs font-bold",children:["★ ",e.rating.toFixed(1)]})]}),title:(0,r.jsx)(d(),{href:"/detail?id=".concat(e.movieId._id),className:"text-white hover:text-red-500 list-item-title",children:e.movieId.name}),description:(0,r.jsx)("div",{style:{color:"#9CA3AF"},className:"jsx-1e87211474166fef",children:(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex flex-col",children:[(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center mb-1",children:[(0,r.jsx)(N.A,{disabled:!0,value:e.rating,allowHalf:!0,className:"custom-rate text-sm"}),(0,r.jsx)("span",{className:"jsx-1e87211474166fef ml-2 text-yellow-500 font-bold",children:e.rating.toFixed(1)})]}),(0,r.jsxs)("div",{className:"jsx-1e87211474166fef flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{className:"jsx-1e87211474166fef",children:e.movieId.category||"Anime"}),(0,r.jsxs)("span",{className:"jsx-1e87211474166fef",children:["Rated on ",new Date(e.createdAt).toLocaleDateString()]})]})]})})}),(0,r.jsx)("div",{className:"jsx-1e87211474166fef flex space-x-2",children:(0,r.jsx)(g.Ay,{type:"primary",style:{backgroundColor:"#EF4444",borderColor:"#EF4444"},size:"small",onClick:()=>er.push("/detail?id=".concat(e.movieId._id)),children:"View Details"})})]})})}]})]})}),(0,r.jsx)(o(),{id:"1e87211474166fef",children:".profile-tabs .ant-tabs-tab{color:white!important}.profile-tabs .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn{color:#EF4444!important}.profile-tabs .ant-tabs-ink-bar{}.profile-edit-modal .ant-modal-header{background-color:#1F2937;border-bottom:1px solid#374151}.profile-edit-modal .ant-modal-title{color:white}.profile-edit-modal .ant-modal-close-x{color:white}.profile-edit-modal .ant-form-item-label>label{color:#D1D5DB}.favorite-card .ant-card-meta-title,.list-item-title{color:white!important}.category-badge{position:absolute;top:8px;left:8px;background-color:rgba(0,0,0,.7);color:#EF4444;font-size:.75rem;padding:2px 8px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;z-index:5}.episode-badge{position:absolute;top:8px;left:8px;background-color:#EF4444;color:white;font-size:.75rem;padding:2px 8px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;z-index:5}.views-badge{position:absolute;top:8px;right:8px;background-color:rgba(0,0,0,.7);color:white;font-size:.75rem;padding:2px 8px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;z-index:5}.views-badge .view-icon,.rating-badge .star-icon{margin-right:4px}.ant-rate{color:#FBBF24;font-size:1rem}.ant-rate-star{margin-right:4px}.ant-rate-star-first,.ant-rate-star-second{color:#FBBF24}.ant-rate-star-half .ant-rate-star-first{color:#FBBF24;-webkit-filter:drop-shadow(0 0 1px rgba(251,191,36,.5));filter:drop-shadow(0 0 1px rgba(251,191,36,.5))}.ant-rate-star-full .ant-rate-star-second{color:#FBBF24}.ant-rate-star-zero .ant-rate-star-first,.ant-rate-star-zero .ant-rate-star-second{color:rgba(251,191,36,.3)}.custom-rate .ant-rate-star{font-size:16px}.favorite-btn{z-index:10}.favorite-btn .ant-btn{min-width:32px;min-height:32px;-webkit-box-shadow:0 2px 4px rgba(0,0,0,.3);-moz-box-shadow:0 2px 4px rgba(0,0,0,.3);box-shadow:0 2px 4px rgba(0,0,0,.3)}.favorite-btn .ant-btn:hover{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);-webkit-transition:-webkit-transform.2s ease;-moz-transition:-moz-transform.2s ease;-o-transition:-o-transform.2s ease;transition:-webkit-transform.2s ease;transition:-moz-transform.2s ease;transition:-o-transform.2s ease;transition:transform.2s ease}.favorite-btn .anticon{font-size:16px}.favorite-card:hover .favorite-btn .ant-btn{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);-webkit-transition:-webkit-transform.2s ease;-moz-transition:-moz-transform.2s ease;-o-transition:-o-transform.2s ease;transition:-webkit-transform.2s ease;transition:-moz-transform.2s ease;transition:-o-transform.2s ease;transition:transform.2s ease}.heart-btn{width:32px!important;height:32px!important;padding:0!important;display:-webkit-box!important;display:-webkit-flex!important;display:-moz-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-pack:center!important;-webkit-justify-content:center!important;-moz-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-moz-box-align:center!important;-ms-flex-align:center!important;align-items:center!important;background-color:#EF4444!important;border-color:#EF4444!important}.ant-list-item .ant-list-item-meta-title a{color:white!important}.custom-rate .ant-rate-star:not(.ant-rate-star-full):hover{-webkit-transform:scale(1.4);-moz-transform:scale(1.4);-ms-transform:scale(1.4);-o-transform:scale(1.4);transform:scale(1.4);-webkit-transition:all.3s cubic-bezier(.18,.89,.32,1.28);-moz-transition:all.3s cubic-bezier(.18,.89,.32,1.28);-o-transition:all.3s cubic-bezier(.18,.89,.32,1.28);transition:all.3s cubic-bezier(.18,.89,.32,1.28)}.custom-rate .ant-rate-star-first:hover,.custom-rate .ant-rate-star-second:hover{color:#F59E0B;-webkit-filter:drop-shadow(0 0 2px rgba(245,158,11,.5));filter:drop-shadow(0 0 2px rgba(245,158,11,.5))}.rating-badge span.text-xs{display:inline-block;font-size:.75rem;color:#D1D5DB;font-weight:normal;margin-left:3px}"})]})}},4740:(e,t,s)=>{Promise.resolve().then(s.bind(s,3246))}},e=>{var t=t=>e(e.s=t);e.O(0,[275,48,183,217,963,546,417,120,441,684,358],()=>t(4740)),_N_E=e.O()}]);